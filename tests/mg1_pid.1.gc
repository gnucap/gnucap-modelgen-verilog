
attach ../modelgen_0.so
attach ../d_vasrc.so

verilog
options trsteporder 1
options numdgt = 8

`modelgen
module pid1(sp,sn,cp,cn);
	inout sp,sn,cp,cn;
	electrical sp,sn,cp,cn;

	parameter real p = 1.;
	parameter real i = 1.;
	parameter real d = 1.;

	analog begin
		I(sp,sn) <+ p * V(cp,cn);
		I(sp,sn) <+ i * idt(V(cp,cn));
		I(sp,sn) <+ d * ddt(V(cp,cn));
   end
endmodule

!make pid1.so > /dev/null
load ./pid1.so

pid1 #(.d(1m) .i(100) .p(.1)) dut (0, out, n1, 0);
capacitor #(.c(1u)) c(out 0);
resistor #(.r(1)) r(out 0);
list
spice

V1 n1 0 sin amplitude=1 freq=100

.print tran v(nodes) iter(0) timef(dut.ddt_*)

.tran 10m
.end
