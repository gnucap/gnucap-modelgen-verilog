attach ./modelgen_0.so

//options nobypass

spice
.subckt vsin p n
.parameter ampl
.parameter dc
V1 p n sin freq=1 amplitude={ampl} dc=dc
.ends

.verilog

`modelgen
module test_xdt1(p, n, ni);
	electrical p, n;
	electrical ni;
	(* desc="" *) real v;
	(* desc="" *) real ddtidt;
	analog begin
		I(ni) <+ -idt(V(p,n));
		v = V(ni);
		ddtidt = ddt(V(ni));
	end
endmodule

!make test_xdt1.so > /dev/null
attach ./test_xdt1.so

verilog
parameter r=1
parameter v=0

test_xdt1 #() dut(1,0,ii);
resistor #(1.) r1(ii,0);
vsin #(.dc(v), .ampl(1)) v1(1, 0);

list

print tran v(1) v(r1)
print tran + iter(0)
tran 1 .1 trace=n
print tran + ddtidt(dut) v(dut)
print tran + i(dut.*)
tran 0 1 .1 trace=n
status notime
end
